<div class="post-show">

  <%= render "common/profile_bar", user: @user_profile, page: "post-show" %>

  <div class="post-show__container center">
    <div class="title"><%= "#{@user_profile.user_name}さんの投稿詳細" %></div>

    <div class="post-show__content">

      <div class="post-show__main">
        <div class="post-show__name">
          <%= @youtuber.name %>
        </div>
        <div class="post-show__genre">
          <%= "ジャンル：#{@youtuber.genre.genre_name}" %>
        </div>
        <div class="post-show__evaluation">
          <div class ="review-evaluation" data-score="<%= @youtuber.evaluation %>"></div>
          <div><%= "#{@youtuber.evaluation}/5" %></div>
        </div>
        <div class="post-show__introduce">
          <div>おすすめポイント</div>
          <div>
            <%= @youtuber.content %>
          </div>
        </div>
      </div>

      <div class="post-show__sub">
        <% if @youtuber.user == current_user %>
          <div class="post-show__edit">
            <%= link_to "編集", edit_youtuber_path(@youtuber), class: "btn btn__post-show--blue" %>
          </div>
          <div class="post-show__delete">
            <%= link_to "削除", youtuber_path(@youtuber), method: :delete, class: "btn btn__post-show--red" %>
          </div>
        <% end %>

        <div id="favorites_buttons_<%= @youtuber.id %>">
          <%= render "public/favorites/favorite", youtuber: @youtuber %>
        </div>
        <div class="post-show__time">
          <%= "投稿日時：#{@youtuber.created_at.strftime('%Y/%m/%d %H:%M:%S')}" %>
        </div>
      </div>

    </div>

    <div class="comment">
      <div class="comment__top">
        <div>
          <%= "#{@youtuber.number_of_comments}件のコメント" %>
        </div>
        <div>
          <%= link_to "コメントを投稿", {anchor: "comment"}, class: "comment__link" %>
        </div>
      </div>
      <div>
        <% @youtuber_comments.each do |comment| %>
          <div class="comment__item">
            <div class="comment__image-tag">
              <%= link_to user_path(comment.user) do %>
                <%= attachment_image_tag comment.user, :image, :fill, 60, 60, fallback: "no_image.jpg", size: "60x60", class: "comment__image" %>
              <% end %>
            </div>
            <div class="comment__main">
              <div class="comment__name">
                <%= comment.user.user_name %>
              </div>
              <div class="comment__area">
                <%= comment.content %>
              </div>
            </div>
            <div class="comment__delete-tag">
              <% if comment.user.id == current_user.id %>
                <div class="comment__delete">
                  <%= link_to "削除", youtuber_comment_path(comment.youtuber, comment), method: :delete, class: "btn btn__post-show--red" %>
                </div>
              <% end %>
            </div>
            <span class="comment__time">コメント日時：<%= comment.created_at.strftime('%Y/%m/%d %H:%M:%S') %></span>
          </div>
        <% end %>
      </div>
      <div class="comment__form" id="comment">
        <%= form_with model: [@youtuber, @comment], local: true do |f| %>
          <%= f.text_area :content %>
          <%= f.submit "コメント投稿" %>
        <% end %>
      </div>
    </div>

    <%= link_to new_youtuber_path do %>
      <button class="create-post">+</button>
    <% end %>
  </div>

  <%= render "common/genre_search_bar", genres: @genres %>

</div>

<script>
$('.review-evaluation').empty();
  $('.review-evaluation').raty({
    readOnly: true,
    number: 5,
    score: function() {
      return $(this).attr('data-score');
    },
    path: '/assets/'
  });
</script>