<div class="post-show">

  <%= render "common/profile_bar", user: @user_profile, page: "post-show" %>

  <div class="post-show__center">
    <div class="post-show__title"><%= "#{@user_profile.user_name}さんの投稿詳細" %></div>

    <div class="post-show__content">

      <div class="post-show__main">
        <h2>
          <%= @youtuber.name %>
        </h2>
        <div>
          <%= "ジャンル：#{@youtuber.genre.genre_name}" %>
        </div>
        <div>
          <span class ="review-evaluation" data-score="<%= @youtuber.evaluation %>"></span>
          <span><%= "#{@youtuber.evaluation}/5" %></span>
        </div>
        <div>
          <%= @youtuber.content %>
        </div>
      </div>

      <div class="post-show__sub">
        <div>
          <%= link_to "編集", edit_youtuber_path(@youtuber) %>
        </div>
        <div>
          <%= link_to "削除", youtuber_path(@youtuber), method: :delete %>
        </div>
        <div>
          <% if @youtuber.favorited_by?(current_user) %>
            <%= link_to "お気に入り解除#{@youtuber.number_of_favorites}", youtuber_favorites_path(@youtuber), method: :delete %>
          <% else %>
            <%= link_to "お気に入り登録#{@youtuber.number_of_favorites}", youtuber_favorites_path(@youtuber), method: :post %>
          <% end %>
        </div>
      </div>

    </div>

    <div class="comment">
      <div class="comment__top">
        <%= "#{@youtuber.comments.count}件のコメント" %>
        <%= link_to "コメントを投稿", {anchor: "comment"} %>
      </div>
      <div class="comment__index">
        <% @youtuber.comments.each do |comment| %>
          <%= attachment_image_tag comment.user, :image, :fill, 50, 50, fallback: "no_image.jpg" %>
          <%= comment.user.user_name %>
          <%= comment.content %>
          <% if comment.user.id == current_user.id %>
            <%= link_to "削除", youtuber_comment_path(comment), method: :delete %>
          <% end %>
        <% end %>
      </div>
      <div class="comment__form" id="comment">
        <%= form_with model: [@youtuber, @comment], local: true do |f| %>
          <%= f.text_area :content %>
          <%= f.submit "コメント投稿" %>
        <% end %>
      </div>
    </div>



    <%= link_to new_youtuber_path do %>
      <button class="create-post">+</button>
    <% end %>
  </div>

  <%= render "common/genre_search_bar", genres: @genres %>

</div>

<script>
$('.review-evaluation').empty();
  $('.review-evaluation').raty({
    readOnly: true,
    number: 5,
    score: function() {
      return $(this).attr('data-score');
    },
    path: '/assets/'
  });
</script>